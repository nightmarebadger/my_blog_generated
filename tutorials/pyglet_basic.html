
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="A-very-basic-Pyglet-tutorial">A very basic Pyglet tutorial<a class="anchor-link" href="#A-very-basic-Pyglet-tutorial">&#182;</a></h1>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>In this tutorial we will look over the very basics of <a href="http://pyglet.org/">Pyglet</a>, a cross-platform windowing and multimedia library for Python.</p>
<p>I came across Pyglet while looking for a library with which I could make a simple game. Of course I first found and tested out <a href="http://www.pygame.org/">Pygame</a>, but for some reason, it didn't exactly click with me, so I continued looking. I later came across the before-mentioned Pyglet and found it to be really nice and very suited for my needs and tastes. So, let's look at how we can make a very simple game with Pyglet.</p>
<p>Pyglet also has no external dependencies, which was a plus for me since it meant a very easy installation/usage in places where you didn't have admin rights and is powered by OpenGL, meaning everything is hardware accelerated and you can even use Pyglet to do some 3D graphical rendering, which was what I wanted to continue with.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Pyglet-basics">Pyglet basics<a class="anchor-link" href="#Pyglet-basics">&#182;</a></h1>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>The very basics that we usually do in a Pyglet game are the following:</p>
<ul>
<li>Define a window object</li>
<li>Override the <code>on_draw()</code> function</li>
<li>Schedule your game logic using <code>pyglet.clock</code></li>
<li>Run the application with <code>pyglet.app.run()</code></li>
</ul>
<p>I doubt this needs an extra explanation, so let us just look at the bare bones program.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sample-bare-bones-program">Sample bare bones program<a class="anchor-link" href="#Sample-bare-bones-program">&#182;</a></h2>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">pyglet</span>

<span class="n">game_window</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">Window</span><span class="p">()</span>

<span class="nd">@game_window.event</span>
<span class="k">def</span> <span class="nf">on_draw</span><span class="p">():</span>
    <span class="n">game_window</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">pyglet</span><span class="o">.</span><span class="n">clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">pyglet</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, a picture of what this does.</p>
<p><img src="images/pyglet_basic/example_bare_bones.png" alt="Pyglet bare bones program"></p>
<p>You might say &quot;This is just a blank screen, that's not very impressive&quot; but think about it a little more. In just 14 lines of code, we made a new window that is integrated with our window manager (meaning it can be moved, resized, minimized etc.), which calls an update function twice per second, we overrode the the <code>on_draw()</code> function into which we can later input our screen drawing. On top of all that, the application already listens for key presses and clicks (try pressing <em>ESC</em> to see how it works). So I believe that even this is a good start.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Sample-bare-bones-program---in-depth">Sample bare bones program - in depth<a class="anchor-link" href="#Sample-bare-bones-program---in-depth">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>We start by making a game window, which is of the <code>pyglet.window.Window</code> class.</p>
<p>On line 5, we override the <code>on_draw</code> function using a <code>game_window.event</code> decorator, and make sure the screen is cleared using the game window <code>clear</code> function.</p>
<p>On line 9, we make a dummy <code>update</code> function, which expects the <code>dt</code> argument. The <code>dt</code> stands for delta time, and will tell us how much time passed since the function was last called. You will see where this comes in handy later on.</p>
<p>Just before calling the <code>pyglet.app.run()</code> command, which actually starts the application up, we call the <code>pyglet.clock.schedule_interval</code> function, which expects two parameters - the function that is called, and the minimum time that passes between each call. We set it to call our update function every half second, or in other words, twice per second (of course if our application slows down it might not be called as many times, but don't worry, the <code>dt</code> parameter will still be correct).</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Resources">Resources<a class="anchor-link" href="#Resources">&#182;</a></h1>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's talk about resources and more specifically, resource management. Since we do not want to load the same resource (image, sound, ...) more then once, Pyglet provides us with the <code>pyglet.resource</code> helpers. Using those, we can load the resource just once and then continue to use it through our application. We usually do this in a separate file, so we have all the resources loaded in the same place.</p>
<p>In our example, we keep all our resources under the <em>resource</em> folder. To load them, we first call <code>pyglet.resource.path</code> to set the path to our resources folder, call <code>pyglet.resource.reindex</code> so the system finds our images and then we load both images we will use using <code>pyglet.resource.image</code>. We do this in the <strong>resources.py</strong> file.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">pyglet</span>

<span class="n">pyglet</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;resources&quot;</span><span class="p">]</span>
<span class="n">pyglet</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">reindex</span><span class="p">()</span>

<span class="n">player</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="s">&quot;player.png&quot;</span><span class="p">)</span>
<span class="n">enemy</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">resource</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="s">&quot;enemy.png&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Making-the-game">Making the game<a class="anchor-link" href="#Making-the-game">&#182;</a></h1>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preparation">Preparation<a class="anchor-link" href="#Preparation">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>In our simple game we will use two different sprites - one for our player and the other for enemies. For now the enemies will remain stationary and there will be no collision detection. We will be able to move our player using the arrow keys.</p>
<p>Let's look over the things we will need.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sprites">Sprites<a class="anchor-link" href="#Sprites">&#182;</a></h3>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>As elsewhere, the most basic object we will use in our game is the <code>Sprite</code>. Sprites are basically images that represent parts of our game (be it parts of the world, the player, monsters, effects, ... ), which can be moved, scaled, rotated, ... As such, sprites have variables <code>x</code>, <code>y</code>, <code>scale</code>, <code>rotation</code> etc.</p>
<p>Our more complex Player or Monster classes will usually be a subclass of <code>pyglet.sprite.Sprite</code>.</p>
<p>Every sprite can be drawn in the <code>on_draw</code> function using it's <code>draw()</code> method.</p>
<p>Let's look at an example of drawing a sprite on the screen.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">pyglet</span>
<span class="kn">import</span> <span class="nn">resources</span>

<span class="n">game_window</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">Window</span><span class="p">()</span>

<span class="nd">@game_window.event</span>
<span class="k">def</span> <span class="nf">on_draw</span><span class="p">():</span>
    <span class="n">game_window</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">sprite</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">sprite</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span><span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

    <span class="n">pyglet</span><span class="o">.</span><span class="n">clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">pyglet</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Rendered, it looks like this:</p>
<p><img src="images/pyglet_basic/example_sprite.png" alt="Drawing a single Sprite"></p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Drawing-multiple-sprites">Drawing multiple sprites<a class="anchor-link" href="#Drawing-multiple-sprites">&#182;</a></h4>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>Of course when drawing more then one sprite, we do not have to do it by hand. Pyglet supports <em>batches</em>, with which you can easily (and quickly) draw all the sprites in the batch using a single command by using the <code>draw()</code> method of the batch.</p>
<p>To use batches, you first create the <code>pyglet.graphics.Batch</code>, then pass it when creating the sprite as the optional <code>batch</code> argument, like this:</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">batch</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">Batch</span><span class="p">()</span>
<span class="n">player</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span><span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="n">batch</span><span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>More information about sprites can be found in the <a href="http://www.pyglet.org/doc/api/pyglet.sprite-module.html">official documentation</a>.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Handling-key-presses">Handling key presses<a class="anchor-link" href="#Handling-key-presses">&#182;</a></h3>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>In Pyglet, you handle keyboard and mouse presses with game window events. We will only use the <code>on_key_press</code> one, but many more exist. For more information, look at the official documentation for <a href="http://www.pyglet.org/doc/programming_guide/working_with_the_keyboard.html">working with the keyboard</a> and <a href="http://www.pyglet.org/doc/programming_guide/working_with_the_mouse.html">working with the mouse</a>.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Story">Story<a class="anchor-link" href="#Story">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>Of course, every game needs a story. Our very simple game will also have a very simple story, which goes as follows:</p>
<blockquote>
<p>You are a simple housewife, but when your husband (a mafia crime lord) hasn't been home for dinner in two days it's time to go get him and show him who wears the pants in your house!</p>
</blockquote>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Putting-it-all-together">Putting it all together<a class="anchor-link" href="#Putting-it-all-together">&#182;</a></h2>
</div>

<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we learned everything we need for this story, we can go and make everything work together. First, we will look at the full code, then parts will be explained in depth.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Full-code">Full code<a class="anchor-link" href="#Full-code">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="kn">from</span> <span class="nn">pyglet.window</span> <span class="kn">import</span> <span class="n">key</span>
<span class="kn">import</span> <span class="nn">pyglet</span>
<span class="kn">import</span> <span class="nn">resources</span>

<span class="n">fps_display</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">clock</span><span class="o">.</span><span class="n">ClockDisplay</span><span class="p">(</span>
    <span class="n">format</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%(fps).1f</span><span class="s">&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">game_window</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span>
    <span class="n">caption</span><span class="o">=</span><span class="s">&quot;Catch your husband!&quot;</span>
<span class="p">)</span>

<span class="n">game_window</span><span class="o">.</span><span class="n">set_mouse_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">pyglet</span><span class="o">.</span><span class="n">gl</span><span class="o">.</span><span class="n">glClearColor</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">player</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span><span class="n">resources</span><span class="o">.</span><span class="n">player</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">player_x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">player_y</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">player_speed</span> <span class="o">=</span> <span class="mi">150</span>

<span class="n">enemies_batch</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">Batch</span><span class="p">()</span>
<span class="n">enemies_sprites</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">boss</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span><span class="n">resources</span><span class="o">.</span><span class="n">boss</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">550</span><span class="p">)</span>
<span class="n">boss</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="nd">@game_window.event</span>
<span class="k">def</span> <span class="nf">on_draw</span><span class="p">():</span>
    <span class="n">game_window</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">enemies_batch</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">boss</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">player</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">fps_display</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>


<span class="nd">@game_window.event</span>
<span class="k">def</span> <span class="nf">on_key_press</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">modifiers</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">player_x</span><span class="p">,</span> <span class="n">player_y</span>
    <span class="k">if</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
        <span class="n">player_x</span> <span class="o">=</span> <span class="o">-</span><span class="n">player_speed</span>
        <span class="n">player_y</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">:</span>
        <span class="n">player_x</span> <span class="o">=</span> <span class="n">player_speed</span>
        <span class="n">player_y</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">UP</span><span class="p">:</span>
        <span class="n">player_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">player_y</span> <span class="o">=</span> <span class="n">player_speed</span>
    <span class="k">elif</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">DOWN</span><span class="p">:</span>
        <span class="n">player_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">player_y</span> <span class="o">=</span> <span class="o">-</span><span class="n">player_speed</span>
    <span class="k">elif</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">SPACE</span><span class="p">:</span>
        <span class="n">player_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">player_y</span> <span class="o">=</span> <span class="mi">0</span>


<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
    <span class="n">player</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">player_x</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">player</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">player_y</span> <span class="o">*</span> <span class="n">dt</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">pyglet</span><span class="o">.</span><span class="n">clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">120</span><span class="p">)</span>
    <span class="n">pyglet</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our &quot;finished&quot; game now looks like this:</p>
<p><img src="images/pyglet_basic/game.png" alt="Catch your husband!"></p>
<p>Everything is more or less self-explanatory, but if you need or want more in-depth information, continue reading.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="FPS-display">FPS display<a class="anchor-link" href="#FPS-display">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">fps_display</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">clock</span><span class="o">.</span><span class="n">ClockDisplay</span><span class="p">(</span>
    <span class="n">format</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%(fps).1f</span><span class="s">&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>pyglet.clock.ClockDisplay</code> is used to show the current FPS. You can see it on the lower-left part of the last screenshot.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Game-window">Game window<a class="anchor-link" href="#Game-window">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">game_window</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span>
    <span class="n">caption</span><span class="o">=</span><span class="s">&quot;Catch your husband!&quot;</span>
<span class="p">)</span>

<span class="n">game_window</span><span class="o">.</span><span class="n">set_mouse_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">pyglet</span><span class="o">.</span><span class="n">gl</span><span class="o">.</span><span class="n">glClearColor</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>We create a <code>Window</code>, setting width to 800px, height to 650px and the caption to &quot;Catch your husband!&quot;. We also disable mouse cursor visibility inside the game and set the <code>glClearColor</code> (the color we clear to when using <code>Window.clear()</code>) to a bluish one.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Player-sprite">Player sprite<a class="anchor-link" href="#Player-sprite">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">player</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span><span class="n">resources</span><span class="o">.</span><span class="n">player</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">player_x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">player_y</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">player_speed</span> <span class="o">=</span> <span class="mi">150</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>We create the player sprite and set it's position to (400, 0). We also create the (global) variables we will use later in the code.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Enemy-sprites">Enemy sprites<a class="anchor-link" href="#Enemy-sprites">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">enemies_batch</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">Batch</span><span class="p">()</span>
<span class="n">enemies_sprites</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">550</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">enemies_sprites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span>
    <span class="n">resources</span><span class="o">.</span><span class="n">enemy</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
    <span class="n">batch</span><span class="o">=</span><span class="n">enemies_batch</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>We create an <em>enemies_batch</em> <code>Batch</code> and an <em>enemies_sprites</em>. We do not actually use this anywhere, but we would usually use something like this so we can iterate over all enemies.</p>
<p>This code could of course be shortened using a for loop and a list of position tuples or something similar.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Boss-sprite">Boss sprite<a class="anchor-link" href="#Boss-sprite">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">boss</span> <span class="o">=</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">sprite</span><span class="o">.</span><span class="n">Sprite</span><span class="p">(</span><span class="n">resources</span><span class="o">.</span><span class="n">boss</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">550</span><span class="p">)</span>
<span class="n">boss</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="mf">0.4</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>We load the boss sprite and scale it down, since it's much bigger then our player and enemy sprites.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Handling-key-presses">Handling key presses<a class="anchor-link" href="#Handling-key-presses">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="nd">@game_window.event</span>
<span class="k">def</span> <span class="nf">on_key_press</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="n">modifiers</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">player_x</span><span class="p">,</span> <span class="n">player_y</span>
    <span class="k">if</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">LEFT</span><span class="p">:</span>
        <span class="n">player_x</span> <span class="o">=</span> <span class="o">-</span><span class="n">player_speed</span>
        <span class="n">player_y</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">:</span>
        <span class="n">player_x</span> <span class="o">=</span> <span class="n">player_speed</span>
        <span class="n">player_y</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">UP</span><span class="p">:</span>
        <span class="n">player_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">player_y</span> <span class="o">=</span> <span class="n">player_speed</span>
    <span class="k">elif</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">DOWN</span><span class="p">:</span>
        <span class="n">player_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">player_y</span> <span class="o">=</span> <span class="o">-</span><span class="n">player_speed</span>
    <span class="k">elif</span> <span class="n">symbol</span> <span class="o">==</span> <span class="n">key</span><span class="o">.</span><span class="n">SPACE</span><span class="p">:</span>
        <span class="n">player_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">player_y</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we set the global <code>player_x</code> and <code>player_y</code> variables to the appropriate value, depending on which key we pressed. If we press one of the arrow keys, we start moving in the direction we pressed and if we press space we stop.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-update-function">The update function<a class="anchor-link" href="#The-update-function">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
    <span class="n">player</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">player_x</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">player</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="n">player_y</span> <span class="o">*</span> <span class="n">dt</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we finally use the delta time we mentioned in the beginning. We multiply the player's speed by the delta time to make sure the movement speed is constant, even when the FPS drops a bit or climbs up. If we didn't do this, our movement would be <em>per frame</em>, meaning the game would actually be slower on slow computers and faster on fast ones, which is a problem that old DOS games had.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-on_draw-function">The on_draw function<a class="anchor-link" href="#The-on_draw-function">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="nd">@game_window.event</span>
<span class="k">def</span> <span class="nf">on_draw</span><span class="p">():</span>
    <span class="n">game_window</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">enemies_batch</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">boss</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">player</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">fps_display</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, we clear the window - if we do not do this, the images from the previous frame would still stay there. This would mean our player wouldn't be <em>moving</em> as such, but rather <em>copying</em> all over the place. Comment out the line and test it out, it's fun (you can also try it with different values in <code>pyglet.clock.schedule_interval</code>) :).</p>
<p>Later on we draw first the enemies, then the boss, then the player and last but not least the FPS. The order here is important, as sprites are drawn one over another - so the later the <code>draw()</code> method is called, the <em>higher</em> up or <em>closer</em> to the screen our sprite will be.</p>
<p>This way, the player is drawn across the boss and the enemies with the FPS always on top of everything else.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-main-function">The main function<a class="anchor-link" href="#The-main-function">&#182;</a></h3>
</div>

<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">
<div class="prompt input_prompt">
In&nbsp;[]:
</div>
<div class="input_area box-flex1">
<div class="highlight"><pre><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">pyglet</span><span class="o">.</span><span class="n">clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">120</span><span class="p">)</span>
    <span class="n">pyglet</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>All that remains is to actually start up the application, which is done with the <code>pyglet.app.run()</code> command. Before that we schedule an interval call to our update function and set it to <span class="math">\(\frac{1}{120}\)</span>, meaning we call the command 120 times per second. Since vertical sync is automatically enabled, we will not see more then 60 FPS, but the update function will still be called 120 times per second.</p>
</div>